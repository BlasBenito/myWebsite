response = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = vi_predictors_numeric[10:5],
quiet = FALSE
)
testthat::expect_message(
x <- validate_arg_preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = vi_predictors_numeric[10:5],
quiet = FALSE
),
regexp = "predictors from lower to higher multicollinearity"
)
x <- validate_arg_preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = vi_predictors_numeric[10:5],
quiet = FALSE
)
testthat::expect_message(
x <- validate_arg_preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = vi_predictors_numeric[10:5],
quiet = FALSE
),
regexp = "4 'predictors' from lower to higher multicollinearity"
)
testthat::expect_true(
attributes(x)$validated
)
testthat::expect_true(
is.data.frame(x)
)
testthat::expect_true(
nrow(x) == length(vi_predictors_numeric[1:10])
)
testthat::expect_true(
x$predictor[1] == vi_predictors_numeric[10]
)
testthat::expect_true(
all(vi_predictors_numeric[1:10] %in% x$predictor)
)
testthat::expect_true(
unique(x$response) == "vi_numeric"
)
testthat::expect_true(
is.na(unique(x$f))
)
testthat::expect_true(
is.na(unique(x$f))
)
unique(x$f)
unique(x$metric)
testthat::expect_true(
all(unique(x$metric) %in% c("user_preference", "1 - R-squared"))
)
preference_df <- preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:12],
quiet = TRUE
)
x <- validate_arg_preference_order(
df = vi_smol,
response  = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
quiet = FALSE
)
testthat::expect_true(
attributes(x)$validated
)
testthat::expect_true(
is.data.frame(x)
)
testthat::expect_true(
nrow(x) == length(vi_predictors_numeric[1:10])
)
testthat::expect_true(
x$predictor[1] == preference_df[1, "predictor"]
)
testthat::expect_true(
all(vi_predictors_numeric[1:10] %in% x$predictor)
)
testthat::expect_true(
unique(x$response) == "vi_numeric"
)
testthat::expect_true(
unique(x$f) == "f_numeric_glm"
)
preference_df <- preference_order(
df = vi_smol,
responses = c("vi_numeric", "vi_binomial"),
predictors = vi_predictors_numeric[1:12],
quiet = TRUE
)
testthat::expect_true(
all(c("vi_numeric", "vi_binomial") %in% preference_df$response)
)
x <- validate_arg_preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
)
testthat::expect_true(
attributes(x)$validated
)
testthat::expect_true(
is.data.frame(x)
)
testthat::expect_true(
nrow(x) == length(vi_predictors_numeric[1:10])
)
testthat::expect_true(
unique(x$response) == "vi_numeric"
)
testthat::expect_true(
length(setdiff(preference_df$predictor, vi_predictors_numeric[1:10])) == 2
)
#wrong response ----
preference_df <- preference_order(
df = vi_smol,
responses = c("vi_numeric", "vi_binomial"),
predictors = vi_predictors_numeric[1:12],
quiet = TRUE
)
testthat::expect_error(
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
),
regexp = "column 'response' of dataframe 'preference_order' does not match the value of the argument 'response'"
)
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
)
source("~/Dropbox/blas/GITHUB/R_packages/collinear/R/validate_arg_preference_order.R")
f_name <- "validate_arg_preference_order"
f_source <- paste0("../R/", f_name, ".R")
f_test <- paste0("../tests/testthat/test-", f_name, ".R")
codetools::findGlobals(fun = get(f_name))
testthat::test_file(f_test)
covr::file_coverage(
source_files = f_source,
test_files = f_test
)
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
)
source("~/Dropbox/blas/GITHUB/R_packages/collinear/R/validate_arg_responses.R")
source("~/Dropbox/blas/GITHUB/R_packages/collinear/R/validate_arg_preference_order.R")
testthat::expect_message(
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
),
regexp = "argument 'responses' does not contain column  names of 'df' and will be ignored"
) |>
suppressMessages()
x$response
testthat::expect_message(
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
),
regexp = "argument 'responses' does not contain column  names of 'df' and will be ignored"
) |>
suppressMessages()
x
load()
testthat::expect_message(
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
),
regexp = "argument 'responses' does not contain column  names of 'df' and will be ignored"
) |>
suppressMessages()
x
source("~/Dropbox/blas/GITHUB/R_packages/collinear/R/validate_arg_preference_order.R")
testthat::expect_error(
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
),
regexp = "argument 'response' does not match values in the column 'response' of the dataframe 'preference_order'"
)
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
)
source("~/Dropbox/blas/GITHUB/R_packages/collinear/R/validate_arg_responses.R")
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
)
minicheck()
f_name <- "validate_arg_responses"
f_source <- paste0("../R/", f_name, ".R")
f_test <- paste0("../tests/testthat/test-", f_name, ".R")
testthat::test_file(f_test)
covr::file_coverage(
source_files = f_source,
test_files = f_test
)
f_name <- "validate_arg_preference_order"
f_source <- paste0("../R/", f_name, ".R")
f_test <- paste0("../tests/testthat/test-", f_name, ".R")
codetools::findGlobals(fun = get(f_name))
testthat::test_file(f_test)
covr::file_coverage(
source_files = f_source,
test_files = f_test
)
data(
vi_smol,
vi_predictors_numeric
)
#no arguments
testthat::expect_error(
x <- validate_arg_preference_order(
df = NULL,
predictors = NULL,
preference_order = NULL,
function_name = NULL,
quiet = FALSE
),
regexp = "argument 'df' cannot be NULL"
)
# df only ----
testthat::expect_message(
x <- validate_arg_preference_order(
df = vi_smol[, vi_predictors_numeric],
response = NULL,
predictors = NULL,
preference_order = NULL,
quiet = FALSE
),
regexp = "from lower to higher multicollinearity"
) |>
suppressMessages()
testthat::expect_true(
unique(x$metric) == "1 - R-squared"
)
testthat::expect_true(
unique(x$f) == "stats::cor()"
)
testthat::expect_message(
x <- validate_arg_preference_order(
df = vi_smol[, c("vi_numeric", vi_predictors_numeric)],
response = "vi_numeric",
predictors = NULL,
preference_order = NULL,
quiet = FALSE
),
regexp = "from lower to higher multicollinearity"
) |>
suppressMessages()
testthat::expect_true(
unique(x$response) == "vi_numeric"
)
testthat::expect_true(
attributes(x)$validated
)
testthat::expect_true(
all(vi_predictors_numeric %in% x$predictor)
)
#preference_order vector ----
x <- validate_arg_preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = vi_predictors_numeric[1:10],
quiet = FALSE
)
testthat::expect_true(
attributes(x)$validated
)
testthat::expect_true(
is.data.frame(x)
)
testthat::expect_true(
nrow(x) == length(vi_predictors_numeric[1:10])
)
testthat::expect_true(
all(vi_predictors_numeric[1:10] %in% x$predictor)
)
testthat::expect_true(
unique(x$response) == "vi_numeric"
)
testthat::expect_true(
is.na(unique(x$f))
)
testthat::expect_true(
unique(x$metric) == "user_preference"
)
#incomplete preference order ----
testthat::expect_message(
x <- validate_arg_preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = vi_predictors_numeric[10:5],
quiet = FALSE
),
regexp = "4 'predictors' from lower to higher multicollinearity"
)
testthat::expect_true(
attributes(x)$validated
)
testthat::expect_true(
is.data.frame(x)
)
testthat::expect_true(
nrow(x) == length(vi_predictors_numeric[1:10])
)
testthat::expect_true(
x$predictor[1] == vi_predictors_numeric[10]
)
testthat::expect_true(
all(vi_predictors_numeric[1:10] %in% x$predictor)
)
testthat::expect_true(
unique(x$response) == "vi_numeric"
)
testthat::expect_true(
all(unique(x$metric) %in% c("user_preference", "1 - R-squared"))
)
#preference_order dataframe ----
preference_df <- preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:12],
quiet = TRUE
)
x <- validate_arg_preference_order(
df = vi_smol,
response  = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
quiet = FALSE
)
testthat::expect_true(
attributes(x)$validated
)
testthat::expect_true(
is.data.frame(x)
)
testthat::expect_true(
nrow(x) == length(vi_predictors_numeric[1:10])
)
testthat::expect_true(
x$predictor[1] == preference_df[1, "predictor"]
)
testthat::expect_true(
all(vi_predictors_numeric[1:10] %in% x$predictor)
)
testthat::expect_true(
unique(x$response) == "vi_numeric"
)
testthat::expect_true(
unique(x$f) == "f_numeric_glm"
)
#filtering responses ----
preference_df <- preference_order(
df = vi_smol,
responses = c("vi_numeric", "vi_binomial"),
predictors = vi_predictors_numeric[1:12],
quiet = TRUE
)
testthat::expect_true(
all(c("vi_numeric", "vi_binomial") %in% preference_df$response)
)
x <- validate_arg_preference_order(
df = vi_smol,
response = "vi_numeric",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
)
testthat::expect_true(
attributes(x)$validated
)
testthat::expect_true(
is.data.frame(x)
)
testthat::expect_true(
nrow(x) == length(vi_predictors_numeric[1:10])
)
testthat::expect_true(
unique(x$response) == "vi_numeric"
)
testthat::expect_true(
length(setdiff(preference_df$predictor, vi_predictors_numeric[1:10])) == 2
)
#wrong response ----
preference_df <- preference_order(
df = vi_smol,
responses = c("vi_numeric", "vi_binomial"),
predictors = vi_predictors_numeric[1:12],
quiet = TRUE
)
x <- validate_arg_preference_order(
df = vi_smol,
response = "wrong_response",
predictors = vi_predictors_numeric[1:10],
preference_order = preference_df,
function_name = NULL,
quiet = FALSE
)
x
x <- validate_arg_preference_order(
df = vi_smol[, c("vi_numeric", vi_predictors_numeric)],
response = c("vi_numeric", "vi_binomial"),
predictors = vi_predictors_numeric,
preference_order = vi_predictors_numeric,
quiet = FALSE
)
x
response = c("vi_numeric", "vi_binomial")
!is.null(response)
df = vi_smol[, c("vi_numeric", vi_predictors_numeric)]
quiet = FALSE
function_name <- ""
response <- validate_arg_responses(
df = df,
responses = response,
max_responses = 1,
quiet = quiet,
function_name = function_name
)
max_responses = 1
response
response <- c("vi_numeric", "vi_binomial")
!is.null(max_responses) &&
max_responses >= 1
max_responses <- as.integer(max_responses)
length(responses) > max_responses
responses <- c("vi_numeric", "vi_binomial")
length(responses) > max_responses
responses_old <- responses
responses <- responses[1:max_responses]
responses_old <- responses
responses <- responses[1:max_responses]
responses
source("~/Dropbox/blas/GITHUB/R_packages/collinear/R/validate_arg_responses.R")
response
quiet
response <- validate_arg_responses(
df = df,
responses = response,
max_responses = 1,
quiet = quiet,
function_name = function_name
)
colnames(df)
response
response <- c("vi_numeric", "vi_binomial")
responses = response
missing_responses <- setdiff(
x = responses,
y = colnames(df)
)
missing_responses
source("~/Dropbox/blas/GITHUB/R_packages/collinear/R/validate_arg_responses.R")
