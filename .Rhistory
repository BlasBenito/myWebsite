)
reactable::reactable(
df_psi_stats |>
mutate_if(is.numeric, round, 2),
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
reactable::reactable(
df_psi_stats |>
mutate_if(is.numeric, round, 3),
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
reactable::reactable(
df_psi_stats |>
mutate_if(is.numeric, round, 3),
pagination = FALSE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = nrow(df_psi_stats),
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
colnames(df_psi_stats)
distantia::distantia_boxplot(
df = df_psi,
text_cex = 1.4
)
sf_psi_stats <- dplyr::inner_join(
x = covid_counties,
y = df_stats,
by = "name"
)
mapview::mapview(
sf_psi_stats,
zcol = "median",
layer.name = "Median psi",
label = "name",
col.regions = grDevices::hcl.colors(n = 5, palette = "Zissou 1")
)
colnames(sf_psi_stats)
knitr::opts_chunk$set(
fig.width = 8,
fig.height = 6
)
library(distantia)
library(dtw)
library(zoo)
library(dplyr)
library(mapview)
library(reactable)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
rm(la_population)
covid_prevalence |>
reactable::reactable(
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
tsl <- distantia::tsl_initialize(
x = covid_prevalence,
name_column = "name",
time_column = "time"
)
names(tsl)
attributes(tsl[[1]])$name
attributes(tsl[[2]])$name
zoo::index(tsl[["Alameda"]]) |>
head()
zoo::coredata(tsl[["Alameda"]]) |>
head()
distantia::tsl_plot(
tsl = tsl,
columns = 3,
guide = FALSE,
text_cex = 1.2
)
distantia::tsl_plot(
tsl = tsl_subset(
tsl = tsl,
names = c("Los_Angeles", "Kings"),
time = c("2021-09-01", "2022-01-31")
),
guide = FALSE
)
df_time <- distantia::tsl_time(
tsl = tsl
)
df_time |>
dplyr::select(name, class, units, length, resolution, begin, end) |>
reactable::reactable(
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
df_stats <- distantia::tsl_stats(
tsl = tsl,
lags = 1:6 #weeks
)
df_stats |>
dplyr::select(name, min, q1, median, q3, max, sd, range, iq_range, skewness, kurtosis) |>
dplyr::mutate(dplyr::across(dplyr::where(is.numeric), ~ round(.x, 2))) |>
reactable::reactable(
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
df_stats |>
select(name, dplyr::contains("lag")) |>
dplyr::mutate(dplyr::across(dplyr::where(is.numeric), ~ round(.x, 2))) |>
dplyr::rename_with(~ gsub("ac_", "", .)) |>
dplyr::rename_with(~ gsub("_", "", .)) |>
reactable::reactable(
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = TRUE
)
sf_stats <- dplyr::inner_join(
x = covid_counties,
y = df_stats,
by = "name"
)
max_prevalence <- mapview(
sf_stats,
zcol = "max",
label = "name",
col.regions = grDevices::hcl.colors(n = 5, palette = "Zissou 1")
)
sf_psi_stats <- dplyr::inner_join(
x = covid_counties,
y = df_stats,
by = "name"
)
mapview::mapview(
sf_psi_stats,
zcol = "median",
layer.name = "Median psi",
label = "name",
col.regions = grDevices::hcl.colors(n = 5, palette = "Zissou 1")
)
colnames(sf_psi_stats)
knitr::opts_chunk$set(
fig.width = 8,
fig.height = 6
)
library(distantia)
library(dtw)
library(zoo)
library(dplyr)
library(mapview)
library(reactable)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
rm(la_population)
covid_prevalence |>
reactable::reactable(
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
tsl <- distantia::tsl_initialize(
x = covid_prevalence,
name_column = "name",
time_column = "time"
)
names(tsl)
attributes(tsl[[1]])$name
attributes(tsl[[2]])$name
zoo::index(tsl[["Alameda"]]) |>
head()
zoo::coredata(tsl[["Alameda"]]) |>
head()
distantia::tsl_plot(
tsl = tsl,
columns = 3,
guide = FALSE,
text_cex = 1.2
)
distantia::tsl_plot(
tsl = tsl_subset(
tsl = tsl,
names = c("Los_Angeles", "Kings"),
time = c("2021-09-01", "2022-01-31")
),
guide = FALSE
)
df_time <- distantia::tsl_time(
tsl = tsl
)
df_time |>
dplyr::select(name, class, units, length, resolution, begin, end) |>
reactable::reactable(
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
df_stats <- distantia::tsl_stats(
tsl = tsl,
lags = 1:6 #weeks
)
df_stats |>
dplyr::select(name, min, q1, median, q3, max, sd, range, iq_range, skewness, kurtosis) |>
dplyr::mutate(dplyr::across(dplyr::where(is.numeric), ~ round(.x, 2))) |>
reactable::reactable(
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
df_stats |>
select(name, dplyr::contains("lag")) |>
dplyr::mutate(dplyr::across(dplyr::where(is.numeric), ~ round(.x, 2))) |>
dplyr::rename_with(~ gsub("ac_", "", .)) |>
dplyr::rename_with(~ gsub("_", "", .)) |>
reactable::reactable(
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = TRUE
)
sf_stats <- dplyr::inner_join(
x = covid_counties,
y = df_stats,
by = "name"
)
max_prevalence <- mapview(
sf_stats,
zcol = "max",
label = "name",
col.regions = grDevices::hcl.colors(n = 5, palette = "Zissou 1")
)
htmlwidgets::saveWidget(
max_prevalence@map,
file = "la_population.html",
selfcontained = TRUE
)
rm(max_prevalence)
tsl_smol <- distantia::tsl_subset(
tsl = tsl,
names = c("San_Francisco", "Napa", "Solano"),
time = c("2021-01-01", "2023-01-01")
)
distantia::tsl_plot(
tsl = tsl_smol,
guide = FALSE,
text_cex = 1.3
)
tsl_smol |>
distantia::distantia_ls() |>
dplyr::mutate(
psi = round(psi, 3)
) |>
reactable::reactable(
resizable = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
tsl_smol |>
distantia::distantia_dtw() |>
dplyr::mutate(
psi = round(psi, 3)
) |>
reactable::reactable(
resizable = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
xy_dtw <- dtw::dtw(
x = tsl_smol$Solano$prevalence,
y = tsl_smol$San_Francisco$prevalence,
keep = TRUE
)
dtw::dtwPlotTwoWay(xy_dtw, offset = 0.5)
rm(tsl_smol, xy_dtw)
df_psi_ls <- distantia::distantia_ls(
tsl = tsl,
distance = "euclidean"
)
str(df_psi_ls)
df_psi_dtw <- distantia::distantia_dtw(
tsl = tsl
)
str(df_psi_dtw)
df_table <- df_psi_dtw |>
dplyr::select(x, y, psi) |>
dplyr::inner_join(
y = dplyr::select(df_psi_ls, x, y, psi),
by = c("x", "y")
) |>
dplyr::transmute(
x, y,
`psi_dtw` = round(psi.x, 3),
psi_ls = round(psi.y, 3)
)
reactable::reactable(
df_table,
pagination = TRUE,
searchable = TRUE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = 10,
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = FALSE
)
rm(df_table)
df_psi <- df_psi_dtw
df_psi_stats <- distantia::distantia_stats(
df = df_psi
)
reactable::reactable(
df_psi_stats |>
mutate_if(is.numeric, round, 3),
pagination = FALSE,
sortable = TRUE,
showSortable = TRUE,
filterable = TRUE,
resizable = TRUE,
defaultPageSize = nrow(df_psi_stats),
showPageSizeOptions = TRUE,
striped = TRUE,
compact = TRUE,
wrap = FALSE,
fullWidth = TRUE
)
sf_psi_stats <- dplyr::inner_join(
x = covid_counties,
y = df_stats,
by = "name"
)
mapview::mapview(
sf_psi_stats,
zcol = "median",
layer.name = "Median psi",
label = "name",
col.regions = grDevices::hcl.colors(n = 5, palette = "Zissou 1")
)
sf_psi_stats$median
sf_psi_stats <- dplyr::inner_join(
x = covid_counties,
y = df_psi_stats,
by = "name"
)
mapview::mapview(
sf_psi_stats,
zcol = "median",
layer.name = "Median psi",
label = "name",
col.regions = grDevices::hcl.colors(n = 5, palette = "Zissou 1")
)
mapview::mapview(
sf_psi_stats,
zcol = "median",
layer.name = "Median psi",
label = "name",
col.regions = grDevices::hcl.colors(n = 5, palette = "Zissou 1")
)
sf_network <- distantia::distantia_spatial(
df = df_psi,
sf = covid_counties |>
dplyr::select(
name, geometry
),
network = TRUE
)
help(distantia_spatial)
sf_psi <- distantia::distantia_spatial(
df = df_psi,
sf = covid_counties,
network = FALSE
)
#subset one county
sf_psi_subset <- sf_psi[
sf_psi$x == "San_Francisco",
]
#one-to-many visualization
mapview::mapview(
sf_psi_subset,
layer.name = "Psi",
label = "y",
zcol = "psi",
col.regions = grDevices::hcl.colors(n = 5, palette = "Zissou 1")
)
help(color_continuous)
mapview::mapview(
sf_psi_stats,
zcol = "median",
layer.name = "Median psi",
label = "name",
col.regions = distantia::color_continuous()
)
