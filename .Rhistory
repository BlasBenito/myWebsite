blogdown::new_post(title = "distantia-showcase")
build_site()
serve_site()
stop_server()
build_site()
serve_site()
stop_server()
build_site()
serve_site()
stop_server()
build_site()
serve_site()
stop_server()
blogdown:::preview_site()
build_site()
serve_site()
serve_site()
library(blogdown)
serve_site()
stop_server()
blogdown:::preview_site()
stop_server()
install.packages("distantia")
install.packages("distantia")
library(distantia)
library(mapview)
mapview()
build_site()
serve_site()
library(distantia)
library(mapview)
mapview(distantia::covid_counties) |>
htmlwidgets::saveWidget(figure, file = "map.html", selfcontained = TRUE)
library(distantia)
library(mapview)
htmlwidgets::saveWidget(mapview(distantia::covid_counties), file = "map.html", selfcontained = TRUE)
library(distantia)
library(mapview)
x <- mapview(distantia::covid_counties)
htmlwidgets::saveWidget(x, file = "map.html", selfcontained = TRUE)
x <- mapview(distantia::covid_counties)
htmlwidgets::saveWidget(x@map, file = "map.html", selfcontained = TRUE)
in_folder <- "home/blas/Dropbox/GITUB/R_packages/distantia/data_full"
out_folder <- "home/blas/Dropbox/GITHUB/myWebsite/static/data"
dir.exists(in_folder)
dir.exists(out_folder)
in_folder <- "/home/blas/Dropbox/GITHUB/R_packages/distantia/data_full"
out_folder <- "/home/blas/Dropbox/GITHUB/myWebsite/static/data"
dir.exists(in_folder)
dir.exists(out_folder)
in_folder <- "/home/blas/Dropbox/GITHUB/R_packages/distantia/data_full/"
out_folder <- "/home/blas/Dropbox/GITHUB/myWebsite/static/data/"
in_folder <- "/home/blas/Dropbox/GITHUB/R_packages/distantia/data_full/"
out_folder <- "/home/blas/Dropbox/GITHUB/myWebsite/static/data/"
#covid data
readRDS(file = paste0(in_folder, "covid_prevalence.rda"))
covid_prevalence <- readRDS(file = paste0(in_folder, "covid_prevalence.rda"))
covid_polygons <- readRDS(file = paste0(in_folder, "covid_polygons.rda"))
library(sf)
covid_polygons <- readRDS(file = paste0(in_folder, "covid_polygons.rda"))
paste0(in_folder, "covid_polygons.rda")
covid_polygons <- readRDS(file = paste0(in_folder, "covid_polygons.rda"))
library(sf)
covid_polygons <- readRDS(file = paste0(in_folder, "covid_polygons.rda"))
load("~/Dropbox/GITHUB/R_packages/distantia/data_full/covid_polygons.rda")
load(file = paste0(in_folder, "covid_polygons.rda"))
View(covid_polygons)
rownames(covid_polygons) <- NULL
nrow(covid_polygons)
nrow(covid_counties)
names(covid_polygons)
covid_polygons <- covid_polygons |>
dplyr::inner_join(
y = covid_counties |>
sf::st_drop_geometry(),
by = "name"
)
library(arrow)
install.packages("arrow")
View(covid_polygons)
arrow::write_parquet(
x = covid_prevalence,
sink = paste0(out_folder, "covid_prevalence.parquet"))
df <- arrow::read_parquet(paste0(out_folder, "covid_prevalence.parquet"))
View(df)
arrow::write_parquet(
x = covid_polygons,
sink = paste0(out_folder, "covid_polygons.parquet"))
library(sf)
sf::st_write(
obj = covid_polygons,
dsn = paste0(out_folder, "covid_polygons.parquet")
)
help(st_write)
st_drivers()
install.packages("geoarrow")
arrow::write_parquet(
x = covid_polygons,
sink = paste0(out_folder, "covid_polygons.parquet"))
help(geoarrow_writer)
library(geoarrow, quietly = TRUE)
library(arrow, quietly = TRUE)
library(sf, quietly = TRUE)
arrow::write_parquet(
x = covid_polygons,
sink = paste0(out_folder, "covid_polygons.parquet"))
df <- arrow::open_dataset(paste0(out_folder, "covid_polygons.parquet"))
covid_polygons
arrow::write_parquet(
x = covid_polygons,
sink = paste0(out_folder, "covid_polygons.parquet"))
arrow::write_parquet(
x = tibble::as.tibble(covid_polygons),
sink = paste0(out_folder, "covid_polygons.parquet"))
arrow::write_parquet(
x = tibble::as_tibble(covid_polygons),
sink = paste0(out_folder, "covid_polygons.parquet"))
help("write_parquet")
library(arrow, quietly = TRUE)
library(sf, quietly = TRUE)
in_folder <- "/home/blas/Dropbox/GITHUB/R_packages/distantia/data_full/"
out_folder <- "/home/blas/Dropbox/GITHUB/myWebsite/static/data/"
#covid data
covid_prevalence <- readRDS(file = paste0(in_folder, "covid_prevalence.rda"))
load(file = paste0(in_folder, "covid_polygons.rda"))
rownames(covid_polygons) <- NULL
library(arrow, quietly = TRUE)
library(sf, quietly = TRUE)
in_folder <- "/home/blas/Dropbox/GITHUB/R_packages/distantia/data_full/"
out_folder <- "/home/blas/Dropbox/GITHUB/myWebsite/static/data/"
#covid data
covid_prevalence <- readRDS(file = paste0(in_folder, "covid_prevalence.rda"))
load(file = paste0(in_folder, "covid_polygons.rda"))
rownames(covid_polygons) <- NULL
library(geoarrow)
library(arrow)
library(sf)
in_folder <- "/home/blas/Dropbox/GITHUB/R_packages/distantia/data_full/"
out_folder <- "/home/blas/Dropbox/GITHUB/myWebsite/static/data/"
covid_prevalence <- readRDS(file = paste0(in_folder, "covid_prevalence.rda"))
load(file = paste0(in_folder, "covid_polygons.rda"))
rownames(covid_polygons) <- NULL
nrow(covid_polygons)
nrow(covid_counties)
library(distantia)
in_folder <- "/home/blas/Dropbox/GITHUB/R_packages/distantia/data_full/"
out_folder <- "/home/blas/Dropbox/GITHUB/myWebsite/static/data/"
#covid data
covid_prevalence <- readRDS(file = paste0(in_folder, "covid_prevalence.rda"))
load(file = paste0(in_folder, "covid_polygons.rda"))
rownames(covid_polygons) <- NULL
nrow(covid_polygons)
nrow(covid_counties)
covid_polygons <- covid_polygons |>
dplyr::inner_join(
y = covid_counties |>
sf::st_drop_geometry(),
by = "name"
)
arrow::write_parquet(
x = covid_prevalence,
sink = paste0(out_folder, "covid_prevalence.parquet"))
#write prevalence
arrow::write_parquet(
x = covid_prevalence,
sink = paste0(out_folder, "covid_prevalence.parquet"))
#test file
df <- arrow::read_parquet(paste0(out_folder, "covid_prevalence.parquet"))
View(df)
df <- arrow::open_dataset(paste0(out_folder, "covid_prevalence.parquet"))
df
covid_polygons
arrow::write_parquet(
x = covid_polygons,
sink = paste0(out_folder, "covid_polygons.parquet"))
sf::st_write(
obj = covid_polygons,
dsn = paste0(out_folder, "covid_polygons.parquet")
)
df.drivers <- st_drivers()
View(df.drivers)
help(write_geoparquet)
help(write_geoparquet)
??geoparquet
help("geoarrow_writer")
library(distantia, quietly = TRUE)
library(mapview, quietly = TRUE)
library(gt, quietly = TRUE)
install.packages("gt")
library(distantia, quietly = TRUE)
library(mapview, quietly = TRUE)
library(gt, quietly = TRUE)
gt(data = covid_prevalence)
blogdown:::preview_site()
max(covid_prevalence$prevalence)
install.packages("dygraphs")
library(dygraphs)
tsl <- tsl_initialize(
x = covid_prevalence,
name_column = "name",
time_column = "time"
)
dygraphs(tsl[[1]])
library(dygraphs)
dygraphs(tsl[[1]])
library(dygraphs)
dygraph(tsl[[1]])
lapply(
X = tsl[1:5],
FUN = dygraph
)
help(dygraph)
lapply(
X = tsl[1:5],
FUN = function(x){
dygraph(x, main = zoo_name_get(x))
}
)
dygraph(tsl[[1]], main = "Alameda")
dygraph(tsl[[1]], main = "Alameda")
lapply(
X = tsl[1:5],
FUN = function(x){
dygraph(x)
}
)
out <- lapply(
X = tsl[1:5],
FUN = function(x){
dygraph(x)
}
)
for (g in out) print(g)
out <- lapply(
X = tsl[1:5],
FUN = function(x){
dygraph(x, main = zoo_name_get(x))
}
)
for (g in out) print(g)
tsl_plot(
tsl = tsl[1:10],
columns = 2,
guide = FALSE
)
colnames(covid_counties)
mapview(covid_counties, zcol = ~population)
mapview(covid_counties, zcol = "population")
help(mapview)
mapview(
covid_counties,
zcol = "population",
label = "name"
)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
x = la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
la_population
la_population@map
htmlwidgets::saveWidget(
x = la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
par(mar = c(5, 5, 5, 5))
tsl_plot(
tsl = tsl[1:12],
columns = 2,
guide = FALSE,
text_cex = 1.5
)
par(mar = c(5, 5, 5, 5), oma = c(5, 5, 5, 5))
tsl_plot(
tsl = tsl[1:12],
columns = 2,
guide = FALSE,
text_cex = 1.5
)
tsl_plot(
tsl = tsl[1:12],
columns = 2,
guide = FALSE,
text_cex = 1.2
)
library(blogdown)
build_site()
serve_site()
knitr::opts_chunk$set(
fig.width = 7, fig.height = 6
)
library(distantia, quietly = TRUE)
library(sf, quietly = TRUE)
library(mapview, quietly = TRUE)
library(gt, quietly = TRUE)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
gt(data = head(covid_prevalence))
tsl <- tsl_initialize(
x = covid_prevalence,
name_column = "name",
time_column = "time"
)
tsl_plot(
tsl = tsl[1:12],
columns = 2,
guide = FALSE,
text_cex = 1.2
)
distantia_dtw_plot(tsl[c(1, 2)])
distantia_dtw_plot(tsl[c(1, 3)])
distantia_dtw_plot(tsl[c(1, 5)])
distantia_dtw_plot(tsl[c(1, 6)])
distantia_dtw_plot(tsl[c(1, 7)])
distantia_dtw_plot(tsl[c(1, 8)])
distantia_dtw_plot(tsl[c(1, 9)])
distantia_dtw_plot(tsl[c(2, 9)])
distantia_dtw_plot(tsl[c(3, 9)])
distantia_dtw_plot(tsl[c(4, 9)])
distantia_dtw_plot(tsl[c(5, 9)])
library(distantia)
library(sf)
library(mapview)
library(gt)
library(future)
stop_server()
build_site()
serve_site()
knitr::opts_chunk$set(
fig.width = 7, fig.height = 6, cache = TRUE
)
knitr::opts_chunk$set(
fig.width = 7, fig.height = 6, cache = TRUE
)
library(distantia)
library(dplyr)
library(tidyr)
library(mapview)
library(gt)
library(dygraphs)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
knitr::opts_chunk$set(
fig.width = 7,
fig.height = 6,
cache = TRUE,
cache.path = "custom_cache/"
)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
library(distantia)
library(dplyr)
library(tidyr)
library(mapview)
library(gt)
la_population <- mapview(
covid_counties,
zcol = "population",
label = "name"
)
htmlwidgets::saveWidget(
la_population@map,
file = "la_population.html",
selfcontained = TRUE
)
covid_prevalence |>
head(n = 20) |>
gt::gt() |>
gt::tab_style(
style = gt::cell_text(font = "Montserrat"),
locations = gt::cells_body()
)
tsl <- tsl_initialize(
x = covid_prevalence,
name_column = "name",
time_column = "time"
)
tsl_plot(
tsl = tsl[1:12],
columns = 2,
guide = FALSE,
text_cex = 1.2
)
par(mar = c(3, 3, 1, 1))
zoo_plot(
x = cbind(
tsl$Los_Angeles,
tsl$San_Francisco
),
guide = TRUE
)
df_time <- tsl_time(
tsl = tsl
)
df_time |>
dplyr::select(name, class, units, length, resolution, begin, end) |>
slice_head(n = 5) |>
gt::gt() |>
gt::tab_style(
style = gt::cell_text(font = "Montserrat"),
locations = gt::cells_body()
)
par(mar = c(3, 3, 1, 1))
zoo_plot(
x = cbind(
tsl$Los_Angeles,
tsl$San_Francisco
),
guide = FALSE
)
df_stats <- tsl_stats(
tsl = tsl,
lags = 1:12 #weeks
)
df_stats |>
select(name, q1, median, q3, max, dplyr::contains("lag")) |>
dplyr::arrange(dplyr::desc(max)) |>
gt::gt() |>
gt::fmt_number(decimals = 2) |>
gt::tab_style(
style = gt::cell_text(font = "Montserrat"),
locations = gt::cells_body()
)
df_stats |>
select(name, q1, median, q3, max, ac_lag_1) |>
dplyr::arrange(dplyr::desc(max)) |>
gt::gt() |>
gt::fmt_number(decimals = 2) |>
gt::tab_style(
style = gt::cell_text(font = "Montserrat"),
locations = gt::cells_body()
)
tsl_ac <- df_stats |>
tidyr::pivot_longer(
cols = dplyr::contains("lag"),
names_to = "lag",
values_to = "autocorrelation"
) |>
dplyr::select(
name, autocorrelation
) |>
dplyr::group_by(
name
) |>
dplyr::mutate(
time = dplyr::row_number()
) |>
distantia::tsl_initialize(
name_column = "name",
time_column = "time"
)
zoo_plot(
x = cbind(tsl_ac$Los_Angeles, tsl_ac$San_Francisco, tsl_ac$Kings),
guide = TRUE,
xlab = "Weeks",
ylab = "Autocorrelation"
)
