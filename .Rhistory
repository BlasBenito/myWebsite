importance.df %>%
dplyr::mutate(
mean_min_depth = round(mean_min_depth, 2),
p_value = round(p_value, 2)
) %>%
knitr::kable()
m <- spatialRF::rf_importance(
model = m,
cluster = cluster,
fill.color = colors
)
m <- spatialRF::rf_importance(
model = m,
xy = plants_xy, #needs coordinates for cross-validation
cluster = cluster,
fill.color = colors
)
m$importance$per.variable %>%
dplyr::mutate(
importance.cv = round(importance.cv, 4)
) %>%
knitr::kable()
local.importance <- cbind(
plants_xy,
spatialRF::get_importance_local(m)
)
p1 <- ggplot2::ggplot() +
ggplot2::geom_sf(
data = world,
fill = "white"
) +
ggplot2::geom_point(
data = local.importance,
ggplot2::aes(
x = x,
y = y,
color = climate_bio1_average
)
) +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80)) +
ggplot2::scale_color_gradientn(colors = colors) +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom") +
ggplot2::ggtitle("climate_bio1_average") +
ggplot2::theme(
plot.title = ggplot2::element_text(hjust = 0.5),
legend.key.width = ggplot2::unit(1,"cm")
) +
ggplot2::labs(color = "Importance") +
ggplot2::xlab("Longitude") +
ggplot2::ylab("Latitude")
p2 <- ggplot2::ggplot() +
ggplot2::geom_sf(
data = world,
fill = "white"
) +
ggplot2::geom_point(
data = local.importance,
ggplot2::aes(
x = x,
y = y,
color = human_population
)
) +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80)) +
ggplot2::scale_color_gradientn(colors = colors) +
ggplot2::theme_bw() +
ggplot2::theme(legend.position = "bottom") +
ggplot2::ggtitle("human_population") +
ggplot2::theme(
plot.title = ggplot2::element_text(hjust = 0.5),
legend.key.width = ggplot2::unit(1,"cm")
) +
ggplot2::labs(color = "Importance") +
ggplot2::xlab("Longitude") +
ggplot2::ylab("Latitude")
p1 + p2
spatialRF::plot_response_curves(
m,
quantiles = c(0.1, 0.5, 0.9),
line.color = colors[c(1, 50, 100)],
ncol = 3,
show.data = FALSE
)
spatialRF::plot_response_curves(
m,
quantiles = 0.5,
line.color = colors[100],
ncol = 3
)
response.curves.df <- spatialRF::get_response_curves(m)
spatialRF::plot_response_surface(
model = m,
a = "climate_bio1_average",
b = "neighbors_count",
fill.color = colors
)
spatialRF::print_performance(m)
m <- spatialRF::rf_evaluate(
model = m,
xy = plants_xy,           #data coordinates
repetitions = 30,         #number of spatial folds
training.fraction = 0.75, #training data fraction on each fold
metrics = "r.squared",
cluster = cluster,
verbose = FALSE
)
names(m$evaluation)
pr <- plants_df[, c("x", "y")]
pr$group.2 <- pr$group.1 <- "Training"
pr[m$evaluation$spatial.folds[[1]]$testing, "group.1"] <- "Testing"
pr[m$evaluation$spatial.folds[[25]]$testing, "group.2"] <- "Testing"
p1 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.1
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80))  +
ggplot2::ggtitle("Spatial fold 1") +
ggplot2::theme(
legend.position = "none",
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::xlab("Longitude") +
ggplot2::ylab("Latitude")
p2 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.2
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80)) +
ggplot2::theme(
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::ggtitle("Spatial fold 25") +
ggplot2::xlab("Longitude") +
ggplot2::ylab("")
p1 | p2
pr <- plants_df[, c("x", "y")]
pr$group.2 <- pr$group.1 <- "Training"
pr[m$evaluation$spatial.folds[[1]]$testing, "group.1"] <- "Testing"
pr[m$evaluation$spatial.folds[[30]]$testing, "group.2"] <- "Testing"
pr <- plants_df[, c("x", "y")]
pr$group.2 <- pr$group.1 <- "Training"
pr[m$evaluation$spatial.folds[[1]]$testing, "group.1"] <- "Testing"
pr[m$evaluation$spatial.folds[[29]]$testing, "group.2"] <- "Testing"
p1 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.1
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80))  +
ggplot2::ggtitle("Spatial fold 1") +
ggplot2::theme(
legend.position = "none",
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::xlab("Longitude") +
ggplot2::ylab("Latitude")
p2 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.2
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80)) +
ggplot2::theme(
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::ggtitle("Spatial fold 25") +
ggplot2::xlab("Longitude") +
ggplot2::ylab("")
p1 | p2
m$evaluation$spatial.folds[[1]]$testing
m$evaluation$spatial.folds[[2]]$testing
pr <- plants_xy
pr$group.2 <- pr$group.1 <- "Training"
pr[m$evaluation$spatial.folds[[2]]$testing, "group.1"] <- "Testing"
pr[m$evaluation$spatial.folds[[29]]$testing, "group.2"] <- "Testing"
p1 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.1
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80))  +
ggplot2::ggtitle("Spatial fold 1") +
ggplot2::theme(
legend.position = "none",
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::xlab("Longitude") +
ggplot2::ylab("Latitude")
p2 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.2
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80)) +
ggplot2::theme(
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::ggtitle("Spatial fold 25") +
ggplot2::xlab("Longitude") +
ggplot2::ylab("")
p1 | p2
pr <- plants_xy
pr$group.2 <- pr$group.1 <- "Training"
pr[m$evaluation$spatial.folds[[2]]$testing, "group.1"] <- "Testing"
pr[m$evaluation$spatial.folds[[5]]$testing, "group.2"] <- "Testing"
p1 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.1
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80))  +
ggplot2::ggtitle("Spatial fold 1") +
ggplot2::theme(
legend.position = "none",
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::xlab("Longitude") +
ggplot2::ylab("Latitude")
p2 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.2
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80)) +
ggplot2::theme(
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::ggtitle("Spatial fold 25") +
ggplot2::xlab("Longitude") +
ggplot2::ylab("")
p1 | p2
pr <- plants_xy
pr$group.2 <- pr$group.1 <- "Training"
pr[m$evaluation$spatial.folds[[2]]$testing, "group.1"] <- "Testing"
pr[m$evaluation$spatial.folds[[7]]$testing, "group.2"] <- "Testing"
p1 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.1
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80))  +
ggplot2::ggtitle("Spatial fold 1") +
ggplot2::theme(
legend.position = "none",
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::xlab("Longitude") +
ggplot2::ylab("Latitude")
p2 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.2
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80)) +
ggplot2::theme(
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::ggtitle("Spatial fold 25") +
ggplot2::xlab("Longitude") +
ggplot2::ylab("")
p1 | p2
pr <- plants_xy
pr$group.2 <- pr$group.1 <- "Training"
pr[m$evaluation$spatial.folds[[2]]$testing, "group.1"] <- "Testing"
pr[m$evaluation$spatial.folds[[12]]$testing, "group.2"] <- "Testing"
p1 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.1
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80))  +
ggplot2::ggtitle("Spatial fold 1") +
ggplot2::theme(
legend.position = "none",
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::xlab("Longitude") +
ggplot2::ylab("Latitude")
p2 <- ggplot2::ggplot() +
ggplot2::geom_sf(data = world, fill = "white") +
ggplot2::geom_point(data = pr,
ggplot2::aes(
x = x,
y = y,
color = group.2
),
size = 2
) +
ggplot2::scale_color_viridis_d(
direction = -1,
end = 0.5,
alpha = 0.8,
option = "F"
) +
ggplot2::theme_bw() +
ggplot2::labs(color = "Group") +
ggplot2::scale_x_continuous(limits = c(-170, -30)) +
ggplot2::scale_y_continuous(limits = c(-58, 80)) +
ggplot2::theme(
plot.title = ggplot2::element_text(hjust = 0.5)
) +
ggplot2::ggtitle("Spatial fold 25") +
ggplot2::xlab("Longitude") +
ggplot2::ylab("")
p1 | p2
spatialRF::plot_evaluation(m)
spatialRF::plot_evaluation(
model = m,
fill.color = colors
)
minicheck()
library(dplyr)
root <- "/home/blas/Dropbox/blas/GITHUB/R_packages/spatialRF"
setwd(root)
version <- "1.1.5"
gz_path <- paste0(
root,
"_",
version,
".tar.gz"
)
x <- devtools::build(
pkg = ".",
path = gz_path
)
system(
command = paste0(
"_R_CHECK_SYSTEM_CLOCK_=0; R CMD check --as-cran --timings ",
x
)
read.table(
paste0(root, "/spatialRF.Rcheck/spatialRF-Ex.timings"),
header = TRUE
) |>
dplyr::arrange(dplyr::desc(elapsed))
devtools::submit_cran()
pkgdown::build_site()
library(pkgdown)
pkgdown::build_site()
minicheck()
build()
blogdown:::preview_site()
build()
serve()
unserve()
build()
serve()
build
build()
serve()
unserve()
build()
serve()
